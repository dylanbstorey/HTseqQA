library(ggplot2)
df <- as.data.frame(read.table("test_cum_quals.tbl",header=TRUE))
p <-ggplot(df, aes (x = xlabel, y=ylabel,color =label,group =label))+ geom_point()+geom_line() + theme(axis.text.x = element_text(size = 3 ,angle=90),plot.background = element_blank(),panel.grid.major = element_blank(),panel.grid.minor = element_blank(),panel.background = element_blank())+ ggtitle("Cumulative proportion of qualities
for test")+xlab("Quality Score")+ylab("Cumulative Proportion") + labs(color = "sample")+ theme(axis.text.x = element_text(colour="black"), axis.text.y = element_text(colour="black") , axis.title.x= element_text(vjust=-0.5) , axis.title.y= element_text(vjust=0.25))
ggsave(p,file="test.cqs.ps",dpi=600,width=7,height=5)
df2 <- as.data.frame(read.table("test_nucleotides_by_position.tbl",header=TRUE))
p <- ggplot(df2, aes (x = position, y=value ,fill = nucleotide),position=dodge)+geom_bar(stat="identity",linetype="blank")+theme(axis.text.x = element_text(angle=90),plot.background = element_blank(),panel.grid.major = element_blank(),panel.grid.minor = element_blank(),panel.background = element_blank()) + ggtitle("Nucleotide Distribution for test")  +xlab("Position")+ylab("Proportion")+labs(fill = "Nucleotide Class")+ theme(axis.text.x = element_text(colour="black"), axis.text.y = element_text(colour="black") , axis.title.x= element_text(vjust=-0.5) , axis.title.y= element_text(vjust=0.25))
ggsave(p,file="test.ntbps.ps",dpi=600,width=7,height=5)
df3 <- as.data.frame(read.table("test_quality_distribution.tbl",header=TRUE))
p <- ggplot(df3, aes(x= factor(xlabel),y=ylabel,fill=label, weight = y_weight)) + geom_violin(scale="area",position="identity",linetype="blank") +theme(axis.text.x = element_text(size = 3, angle=90),plot.background= element_blank(),panel.grid.major = element_blank(),panel.grid.minor = element_blank(),panel.background = element_blank())+ ggtitle("Quality Score Distributions by Position")+ xlab("Position") + ylab("Quality Scores") + labs("test")+ theme(axis.text.x = element_text(colour="black"), axis.text.y = element_text(colour="black") , axis.title.x= element_text(vjust=-0.5) , axis.title.y= element_text(vjust=0.25))
ggsave(p,file="test.qdbs.ps",dpi=600,width=7,height=5)
df4 <- as.data.frame(read.table("test_passing_reads.tbl",header=TRUE))
p <- ggplot(df4, aes(x = xlabel, y = ylabel , fill = value)) + geom_tile(aes(fill = value))  + scale_fill_gradient(low="blue", high="white")+theme(axis.text.x = element_text(angle=90),plot.background = element_blank(),panel.grid.major = element_blank(),panel.grid.minor = element_blank(),panel.background = element_blank()) + ggtitle("Passing reads for test")   + ylab("Minimum Quality Score")+xlab("Number of bases >= Minimum Quality") +labs(fill = "Proportion of Reads")+ theme(axis.text.x = element_text(colour="black"), axis.text.y = element_text(colour="black") , axis.title.x= element_text(vjust=-0.5) , axis.title.y= element_text(vjust=0.25))
ggsave(p,file="test.prf.ps",dpi=600,width=7,height=5)
df5 <- as.data.frame(read.table("test_novelty.tbl",header=TRUE))
p <- ggplot(df5, aes(x=novelty,y=count),position=dodge)+geom_histogram(stat="identity")+ggtitle("Uniqueness of reads for test")+ylab ("Number of reads in category")+xlab("Uniqueness score")+ theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),panel.background = element_blank(),plot.background= element_blank(),axis.text.x = element_text(colour="black"), axis.text.y = element_text(colour="black") , axis.title.x= element_text(vjust=-0.5) , axis.title.y= element_text(vjust=0.25))
ggsave(p,file="test.novelty.ps",dpi=600,width=7,height=5)
df6 <- as.data.frame(read.table("test_gcdistributions.tbl",header=TRUE))
p <- ggplot(df6, aes(x=GC,y=count),position=dodge)+geom_histogram(stat="identity")+ggtitle("Read GC content distribution for test")+ylab ("Number of reads")+xlab("Read GC content")+ theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),panel.background = element_blank(),plot.background= element_blank(),axis.text.x = element_text(colour="black"), axis.text.y = element_text(colour="black") , axis.title.x= element_text(vjust=-0.5) , axis.title.y= element_text(vjust=0.25))
ggsave(p,file="test.gcdist.ps",dpi=600,width=7,height=5)
